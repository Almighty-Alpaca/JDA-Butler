plugins {
    id 'java'
    id 'idea'
    id 'application'
    id 'com.github.johnrengelman.shadow' version '2.0.4'
    id 'com.github.ben-manes.versions' version '0.20.0'
    id 'com.sedmelluq.jdaction' version '1.0.2'
}

sourceCompatibility = targetCompatibility = 1.8

compileJava.options.encoding = 'UTF-8'

mainClassName = 'com.almightyalpaca.discord.jdabutler.Bot'

repositories {
    mavenCentral()
    jcenter()
    maven {
        url = 'https://jitpack.io'
    }
}

dependencies {
    // JDA
    compile ('net.dv8tion:JDA:3.8.1_439') {
        exclude module: 'opus-java'
    }

    // Webhooks
    compile group: 'club.minnced', name: 'discord-webhooks', version: '0.1.3'

    // Apache commons Lang 3
    compile group: 'org.apache.commons', name: 'commons-lang3', version: '3.7'

    // Apache Commons Text
    compile group: 'org.apache.commons', name: 'commons-text', version: '1.2'

    // Apache Commons IO
    compile group: 'commons-io', name: 'commons-io', version: '2.6'

    // Groovy JSR-223 / Script engine 
    compile group: 'org.codehaus.groovy', name: 'groovy-jsr223', version: '2.4.13'

    // Gson
    compile group: 'com.google.code.gson', name: 'gson', version: '2.8.2'

    // Guava
    compile group: 'com.google.guava', name: 'guava', version: '24.0-jre'

    // Dropbox
    compile group: 'com.dropbox.core', name: 'dropbox-core-sdk', version: '3.0.6'

    // Zip4J
    compile group: 'net.lingala.zip4j', name: 'zip4j', version: '1.3.2'

    // jsoup HTML parser library @ http://jsoup.org/
    compile group: 'org.jsoup', name: 'jsoup', version: '1.11.2'

    //Logback
    compile 'ch.qos.logback:logback-classic:1.2.3'

    testCompile 'junit:junit:4.12'
}

run {
    systemProperties System.properties
}

dependencyUpdates.resolutionStrategy = {
    componentSelection { rules ->
        rules.all { ComponentSelection selection ->
            if (['alpha', 'beta', 'rc', 'cr', 'm'].any { qualifier -> selection.candidate.version ==~ /(?i).*[.-]${qualifier}[.\d-]*/ }) {
                selection.reject('Release candidate')
            }
        }
    }
}
